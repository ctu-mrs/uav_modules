FROM ctumrs/mrs_uav_system_ls:latest

WORKDIR /home
ENV HOME=/home

RUN mkdir -p /opt/mrs/git && cd /opt/mrs/git && git clone https://github.com/ctu-mrs/uav_modules && chmod -R +666 /opt/mrs/

RUN ln -s /opt/mrs/git/uav_modules /opt/mrs/mrs_workspace/src

RUN cd /opt/mrs/mrs_workspace/src/uav_modules && gitman install && ./installation/install.sh --unattended && rm -rf /var/lib/apt/lists/* && rm -rf /opt/mrs/git/uav_modules/ros_packages/aloam/lib/* && chmod -R +666 /opt/mrs/

RUN cd /opt/mrs/mrs_workspace && catkin build && chmod -R +666 /opt/mrs/

CMD ["bash"]
